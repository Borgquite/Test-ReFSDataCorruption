======== Test iteration 1 of 20... ========
[
19:09:54.560
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:09:54.561
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:10:10.514
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:10:10.519
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xee1a57701a5734b5
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9d7
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:10:10.532
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:10:10.533
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:10:10.533
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:10:15.536
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:10:16.625
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:10:17.431
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:10:18.028
] 
Disconnecting virtual disk
[
19:10:18.107
] 
Dismounting '1.vhdx' to generate corruption...
[
19:10:18.166
] 
Dismounting '2.vhdx' to generate corruption...
[
19:10:18.222
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:10:23.292
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:10:24.348
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:10:24.348
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:10:24.348
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:10:24.353
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:10:25.031
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:10:25.944
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:10:26.371
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:10:26.485
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:10:26.626
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:10:31.826
] 
Connecting virtual disk
[
19:10:31.917
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:10:36.976
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:10:36.978
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:10:36.990
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:10:36.991
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:10:36.995
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:10:36.996
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:10:42.002
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:10:42.312
] 
Disconnecting virtual disk
[
19:10:42.386
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:10:42.433
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:10:42.483
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:10:42.528
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:10:43.538
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:10:44.336
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

[
19:10:44.985
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:10:45.048
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:10:56.847
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:10:56.853
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xac4e73084e72cb1a
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:10:56.860
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:10:56.860
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:10:56.861
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:11:01.864
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:11:02.886
] 
Scanning uncorrupted data in 2.vhdx
[
19:11:03.502
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:11:04.568
] 
Disconnecting virtual disk
[
19:11:04.649
] 
Dismounting '1.vhdx' to generate corruption...
[
19:11:04.703
] 
Dismounting '2.vhdx' to generate corruption...
[
19:11:04.763
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:11:09.832
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:11:10.814
] 
Found 'Corrupt_me_1' at position 339742720 - corrupting following character from ' ' to '!'...
[
19:11:10.815
] 
Found 'Corrupt_me_1' at position 339746816 - corrupting following character from ' ' to '!'...
[
19:11:10.815
] 
Found 'Corrupt_me_1' at position 339750912 - corrupting following character from ' ' to '!'...
[
19:11:10.819
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:11:11.823
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:11:12.440
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:11:12.987
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:11:13.080
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:11:13.133
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:11:18.207
] 
Connecting virtual disk
[
19:11:18.305
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:11:23.351
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:11:23.352
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:11:23.357
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:11:23.358
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:11:23.362
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:11:23.363
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:11:28.379
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:11:28.703
] 
Disconnecting virtual disk
[
19:11:28.770
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:11:28.819
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:11:28.873
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:11:28.926
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:11:29.815
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:11:30.331
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 2 of 20... ========
[
19:11:31.311
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:11:31.377
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:11:43.273
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:11:43.278
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xc6ea8e84ea8e708b
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:11:43.288
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:11:43.289
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:11:43.289
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:11:48.300
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:11:49.326
] 
Scanning uncorrupted data in 2.vhdx
[
19:11:49.821
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:11:50.670
] 
Disconnecting virtual disk
[
19:11:50.748
] 
Dismounting '1.vhdx' to generate corruption...
[
19:11:50.807
] 
Dismounting '2.vhdx' to generate corruption...
[
19:11:50.865
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:11:55.925
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:11:57.041
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:11:57.041
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:11:57.042
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:11:57.046
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:11:57.761
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:11:58.287
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:11:58.902
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:11:59.003
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:11:59.079
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:12:09.199
] 
Connecting virtual disk
[
19:12:09.321
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:12:14.355
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:12:14.356
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:12:14.360
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:12:14.360
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:12:14.365
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:12:14.365
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:12:19.387
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:12:19.676
] 
Disconnecting virtual disk
[
19:12:19.768
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:12:19.828
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:12:19.877
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:12:19.927
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:12:20.862
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:12:21.433
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:12:22.271
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:12:22.337
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:12:34.126
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:12:34.138
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x148cacd78cacb4a0
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:12:34.147
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:12:34.147
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:12:34.148
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:12:39.162
] 
Scanning uncorrupted data in 1.vhdx
[
19:12:39.611
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:12:40.374
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:12:41.562
] 
Disconnecting virtual disk
[
19:12:41.644
] 
Dismounting '1.vhdx' to generate corruption...
[
19:12:41.688
] 
Dismounting '2.vhdx' to generate corruption...
[
19:12:41.743
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:12:46.823
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:12:47.751
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:12:47.751
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:12:47.751
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:12:47.756
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:12:48.180
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:12:49.178
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:12:49.858
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:12:49.934
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:12:55.014
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:13:05.105
] 
Connecting virtual disk
[
19:13:05.201
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:13:10.264
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:13:10.266
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:13:10.272
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:13:10.273
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:13:10.277
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:13:10.277
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:13:15.288
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:13:15.595
] 
Disconnecting virtual disk
[
19:13:15.686
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:13:15.733
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:13:15.784
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:13:15.836
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:13:16.215
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:13:16.992
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 3 of 20... ========
[
19:13:18.004
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:13:18.069
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:13:29.824
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:13:29.828
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xb012ce3312cdfe7a
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:13:29.836
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:13:29.836
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:13:29.837
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:13:34.845
] 
Scanning uncorrupted data in 1.vhdx
[
19:13:35.401
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:13:36.314
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:13:37.332
] 
Disconnecting virtual disk
[
19:13:37.417
] 
Dismounting '1.vhdx' to generate corruption...
[
19:13:37.481
] 
Dismounting '2.vhdx' to generate corruption...
[
19:13:37.534
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:13:42.604
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:13:43.155
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:13:44.377
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:13:44.378
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:13:44.378
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:13:44.382
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:13:44.679
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:13:45.257
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:13:46.062
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:13:46.130
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:13:46.221
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:13:51.349
] 
Connecting virtual disk
[
19:13:51.444
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:13:56.502
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:13:56.503
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:13:56.507
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:13:56.508
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:13:56.510
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:13:56.511
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:14:01.521
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:14:01.843
] 
Disconnecting virtual disk
[
19:14:01.917
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:14:01.963
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:14:02.011
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:14:02.055
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:14:02.482
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:14:03.128
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:14:03.981
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:14:04.045
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:14:15.716
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:14:15.720
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xeecae98ccae9517f
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:14:15.728
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:14:15.729
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:14:15.729
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:14:20.731
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:14:21.545
] 
Scanning uncorrupted data in 2.vhdx
[
19:14:21.894
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:14:22.768
] 
Disconnecting virtual disk
[
19:14:22.856
] 
Dismounting '1.vhdx' to generate corruption...
[
19:14:22.922
] 
Dismounting '2.vhdx' to generate corruption...
[
19:14:22.974
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:14:28.033
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:14:28.994
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:14:28.995
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:14:28.996
] 
Found 'Corrupt_me_1' at position 406863872 - corrupting following character from ' ' to '!'...
[
19:14:28.999
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:14:29.812
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:14:30.190
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:14:30.944
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:14:31.049
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:14:31.127
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:14:36.236
] 
Connecting virtual disk
[
19:14:36.333
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:14:41.375
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:14:41.376
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:14:41.380
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:14:41.381
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:14:41.384
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:14:41.384
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:14:46.402
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:14:46.672
] 
Disconnecting virtual disk
[
19:14:46.759
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:14:46.805
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:14:46.858
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:14:46.905
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:14:47.811
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:14:48.196
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 4 of 20... ========
[
19:14:49.196
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:14:49.272
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:15:00.959
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:15:00.964
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xc8b60460b604517c
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:15:00.974
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:15:00.975
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:15:00.975
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:15:05.980
] 
Scanning uncorrupted data in 1.vhdx
[
19:15:06.466
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:15:07.400
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:15:08.365
] 
Disconnecting virtual disk
[
19:15:08.446
] 
Dismounting '1.vhdx' to generate corruption...
[
19:15:08.505
] 
Dismounting '2.vhdx' to generate corruption...
[
19:15:08.561
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:15:13.623
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:15:14.276
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:15:15.356
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:15:15.357
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:15:15.357
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:15:15.361
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:15:15.820
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:15:16.523
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:15:17.124
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:15:17.242
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:15:22.341
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:15:27.408
] 
Connecting virtual disk
[
19:15:27.507
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:15:32.557
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:15:32.558
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:15:32.564
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:15:32.564
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:15:32.568
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:15:32.569
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:15:37.583
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:15:37.880
] 
Disconnecting virtual disk
[
19:15:37.970
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:15:38.023
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:15:38.070
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:15:38.114
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:15:38.562
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:15:39.367
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:15:40.308
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:15:40.387
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:15:52.002
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:15:52.006
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x0a2622c92622b59b
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:15:52.015
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:15:52.016
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:15:52.016
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:15:57.022
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:15:57.944
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:15:58.683
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:15:59.222
] 
Disconnecting virtual disk
[
19:15:59.307
] 
Dismounting '1.vhdx' to generate corruption...
[
19:15:59.363
] 
Dismounting '2.vhdx' to generate corruption...
[
19:15:59.417
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:16:04.470
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:16:05.026
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:16:05.661
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:16:05.661
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:16:05.663
] 
Found 'Corrupt_me_1' at position 406863872 - corrupting following character from ' ' to '!'...
[
19:16:05.667
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:16:06.584
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:16:07.148
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:16:07.369
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:16:07.448
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:16:07.527
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:16:12.589
] 
Connecting virtual disk
[
19:16:12.675
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:16:17.711
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:16:17.714
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:16:17.718
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:16:17.718
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:16:17.721
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:16:17.723
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:16:22.736
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:16:23.030
] 
Disconnecting virtual disk
[
19:16:23.105
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:16:23.143
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:16:23.193
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:16:23.242
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:16:23.982
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:16:24.699
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

======== Test iteration 5 of 20... ========
[
19:16:25.275
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:16:25.340
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:16:45.219
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:16:45.224
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xdc9e42869e425962
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:16:45.232
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:16:45.233
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:16:45.233
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:16:50.236
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:16:51.048
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:16:51.940
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:16:52.475
] 
Disconnecting virtual disk
[
19:16:52.558
] 
Dismounting '1.vhdx' to generate corruption...
[
19:16:52.625
] 
Dismounting '2.vhdx' to generate corruption...
[
19:16:52.675
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:16:57.818
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:16:59.126
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:16:59.126
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:16:59.127
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:16:59.131
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:16:59.661
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:17:00.707
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:17:01.072
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:17:01.147
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:17:01.238
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:17:06.294
] 
Connecting virtual disk
[
19:17:06.414
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:17:11.466
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:17:11.468
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:17:11.473
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:17:11.475
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:17:11.479
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:17:11.480
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:17:16.492
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:17:16.857
] 
Disconnecting virtual disk
[
19:17:16.945
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:17:16.990
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:17:17.041
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:17:17.090
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:17:17.802
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:17:18.720
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

[
19:17:19.323
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:17:19.390
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:17:31.051
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:17:31.055
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xac9e5dee9e5db216
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:17:31.063
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:17:31.064
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:17:31.065
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:17:36.072
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:17:37.038
] 
Scanning uncorrupted data in 2.vhdx
[
19:17:37.488
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:17:38.285
] 
Disconnecting virtual disk
[
19:17:38.358
] 
Dismounting '1.vhdx' to generate corruption...
[
19:17:38.416
] 
Dismounting '2.vhdx' to generate corruption...
[
19:17:38.469
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:17:43.530
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:17:44.103
] 
Found 'Corrupt_me_1' at position 339746816 - corrupting following character from ' ' to '!'...
[
19:17:44.103
] 
Found 'Corrupt_me_1' at position 339750912 - corrupting following character from ' ' to '!'...
[
19:17:44.104
] 
Found 'Corrupt_me_1' at position 339755008 - corrupting following character from ' ' to '!'...
[
19:17:44.108
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:17:44.854
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:17:45.315
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:17:45.755
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:17:45.862
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:17:45.949
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:17:51.027
] 
Connecting virtual disk
[
19:17:51.142
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:17:56.201
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:17:56.203
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:17:56.207
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:17:56.208
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:17:56.210
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:17:56.211
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:18:01.220
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:18:01.489
] 
Disconnecting virtual disk
[
19:18:01.553
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:18:01.601
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:18:01.650
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:18:01.695
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:18:02.442
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:18:02.865
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 6 of 20... ========
[
19:18:03.685
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:18:03.752
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:18:15.422
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:18:15.426
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xdeae7871ae7843d5
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:18:15.433
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:18:15.433
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:18:15.434
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:18:20.449
] 
Scanning uncorrupted data in 1.vhdx
[
19:18:20.968
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:18:21.666
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:18:22.548
] 
Disconnecting virtual disk
[
19:18:22.625
] 
Dismounting '1.vhdx' to generate corruption...
[
19:18:22.669
] 
Dismounting '2.vhdx' to generate corruption...
[
19:18:22.722
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:18:27.866
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:18:28.377
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:18:29.514
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:18:29.515
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:18:29.516
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:18:29.520
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:18:29.909
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:18:30.542
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:18:31.363
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:18:31.471
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:18:31.571
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:18:36.677
] 
Connecting virtual disk
[
19:18:36.762
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:18:41.800
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:18:41.803
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:18:41.807
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:18:41.808
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:18:41.811
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:18:41.812
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:18:46.821
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:18:47.096
] 
Disconnecting virtual disk
[
19:18:47.180
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:18:47.231
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:18:47.363
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:18:47.404
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:18:47.868
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:18:48.582
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:18:49.476
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:18:49.549
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:19:11.978
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:19:11.983
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x2808988b08985a20
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:19:11.990
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:19:11.990
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:19:11.990
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:19:17.005
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:19:17.867
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:19:18.482
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:19:19.101
] 
Disconnecting virtual disk
[
19:19:19.174
] 
Dismounting '1.vhdx' to generate corruption...
[
19:19:19.235
] 
Dismounting '2.vhdx' to generate corruption...
[
19:19:19.289
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:19:24.439
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:19:24.804
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:19:25.488
] 
Found 'Corrupt_me_1' at position 339742720 - corrupting following character from ' ' to '!'...
[
19:19:25.489
] 
Found 'Corrupt_me_1' at position 339746816 - corrupting following character from ' ' to '!'...
[
19:19:25.489
] 
Found 'Corrupt_me_1' at position 339750912 - corrupting following character from ' ' to '!'...
[
19:19:25.493
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:19:26.435
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:19:26.828
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:19:27.117
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:19:27.260
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:19:27.312
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:19:32.377
] 
Connecting virtual disk
[
19:19:32.465
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:19:37.515
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:19:37.516
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:19:37.520
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:19:37.521
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:19:37.525
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:19:37.526
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:19:42.540
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:19:42.831
] 
Disconnecting virtual disk
[
19:19:42.907
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:19:42.954
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:19:43.003
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:19:43.049
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:19:43.934
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:19:44.562
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

======== Test iteration 7 of 20... ========
[
19:19:45.245
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:19:45.317
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:19:59.555
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:19:59.559
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xd0b0b4ceb0b4bc72
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:19:59.646
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:19:59.647
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:19:59.648
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:20:04.662
] 
Scanning uncorrupted data in 1.vhdx
[
19:20:05.130
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:20:05.702
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:20:06.696
] 
Disconnecting virtual disk
[
19:20:06.782
] 
Dismounting '1.vhdx' to generate corruption...
[
19:20:06.836
] 
Dismounting '2.vhdx' to generate corruption...
[
19:20:06.888
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:20:11.947
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:20:12.406
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:20:13.090
] 
Found 'Corrupt_me_1' at position 339742720 - corrupting following character from ' ' to '!'...
[
19:20:13.090
] 
Found 'Corrupt_me_1' at position 339746816 - corrupting following character from ' ' to '!'...
[
19:20:13.091
] 
Found 'Corrupt_me_1' at position 339750912 - corrupting following character from ' ' to '!'...
[
19:20:13.094
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:20:13.381
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:20:13.841
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:20:14.622
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:20:14.690
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:20:14.787
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:20:19.875
] 
Connecting virtual disk
[
19:20:19.978
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:20:25.029
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:20:25.030
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:20:25.034
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:20:25.035
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:20:25.038
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:20:25.039
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:20:30.044
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:20:30.328
] 
Disconnecting virtual disk
[
19:20:30.410
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:20:30.461
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:20:30.512
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:20:30.558
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:20:30.999
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:20:31.566
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:20:32.535
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:20:32.599
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:20:46.818
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:20:46.824
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x8862d0ca62d0be5e
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9d7
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:20:46.835
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:20:46.835
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:20:46.836
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:20:51.850
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:20:52.428
] 
Scanning uncorrupted data in 2.vhdx
[
19:20:52.867
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:20:53.829
] 
Disconnecting virtual disk
[
19:20:53.906
] 
Dismounting '1.vhdx' to generate corruption...
[
19:20:53.965
] 
Dismounting '2.vhdx' to generate corruption...
[
19:20:54.016
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:20:59.071
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:21:00.363
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:21:00.363
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:21:00.364
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:21:00.367
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:21:01.002
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:21:01.485
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:21:02.138
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:21:02.204
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:21:02.276
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:21:07.387
] 
Connecting virtual disk
[
19:21:07.489
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:21:12.542
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:21:12.543
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:21:12.547
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:21:12.547
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:21:12.550
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:21:12.551
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:21:17.555
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:21:17.844
] 
Disconnecting virtual disk
[
19:21:17.916
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:21:17.958
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:21:18.114
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:21:18.162
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:21:18.731
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:21:19.154
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 8 of 20... ========
[
19:21:20.146
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:21:20.212
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:21:34.498
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:21:34.503
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xfe96eda396ed5d21
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:21:34.509
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:21:34.510
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:21:34.510
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:21:39.516
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:21:40.361
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:21:41.091
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:21:41.721
] 
Disconnecting virtual disk
[
19:21:41.806
] 
Dismounting '1.vhdx' to generate corruption...
[
19:21:41.869
] 
Dismounting '2.vhdx' to generate corruption...
[
19:21:41.922
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:21:46.976
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:21:48.247
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:21:48.247
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:21:48.247
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:21:48.251
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:21:48.827
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:21:49.438
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:21:50.044
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:21:50.117
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:21:50.208
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:21:55.300
] 
Connecting virtual disk
[
19:21:55.400
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:22:00.454
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:22:00.455
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:22:00.460
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:22:00.461
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:22:00.465
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:22:00.465
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:22:05.473
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:22:05.857
] 
Disconnecting virtual disk
[
19:22:05.944
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:22:05.994
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:22:06.043
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:22:06.091
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:22:06.920
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:22:07.501
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

[
19:22:08.193
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:22:08.261
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:22:19.882
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:22:19.887
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xe2f60a12f609e79d
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:22:19.896
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:22:19.897
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:22:19.897
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:22:24.911
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:22:25.563
] 
Scanning uncorrupted data in 2.vhdx
[
19:22:26.033
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:22:27.094
] 
Disconnecting virtual disk
[
19:22:27.168
] 
Dismounting '1.vhdx' to generate corruption...
[
19:22:27.226
] 
Dismounting '2.vhdx' to generate corruption...
[
19:22:27.279
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:22:32.428
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:22:33.199
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:22:33.200
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:22:33.200
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:22:33.204
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:22:33.796
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:22:34.268
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:22:34.838
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:22:34.904
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:22:34.992
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:22:40.092
] 
Connecting virtual disk
[
19:22:40.185
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:22:45.238
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:22:45.240
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:22:45.245
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:22:45.248
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:22:45.251
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:22:45.251
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:22:50.264
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:22:50.558
] 
Disconnecting virtual disk
[
19:22:50.631
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:22:50.689
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:22:50.735
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:22:50.775
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:22:51.441
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:22:51.947
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 9 of 20... ========
[
19:22:53.096
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:22:53.245
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:23:04.946
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:23:04.950
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xfadc2433dc23e899
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:23:04.957
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:23:04.957
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:23:04.957
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:23:09.958
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:23:10.694
] 
Scanning uncorrupted data in 2.vhdx
[
19:23:11.158
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:23:12.285
] 
Disconnecting virtual disk
[
19:23:12.365
] 
Dismounting '1.vhdx' to generate corruption...
[
19:23:12.420
] 
Dismounting '2.vhdx' to generate corruption...
[
19:23:12.473
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:23:17.525
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:23:18.222
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:23:18.223
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:23:18.223
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:23:18.227
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:23:18.723
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:23:19.140
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:23:19.911
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:23:19.981
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:23:20.028
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:23:25.122
] 
Connecting virtual disk
[
19:23:25.221
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:23:30.264
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:23:30.266
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:23:30.272
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:23:30.273
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:23:30.278
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:23:30.280
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:23:35.292
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:23:35.567
] 
Disconnecting virtual disk
[
19:23:35.633
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:23:35.683
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:23:35.733
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:23:35.779
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:23:36.557
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:23:36.974
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:23:38.019
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:23:38.087
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:23:52.270
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:23:52.274
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x3e503fc5503f8327
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:23:52.280
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:23:52.280
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:23:52.281
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:23:57.287
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:23:57.973
] 
Scanning uncorrupted data in 2.vhdx
[
19:23:58.307
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:23:59.293
] 
Disconnecting virtual disk
[
19:23:59.368
] 
Dismounting '1.vhdx' to generate corruption...
[
19:23:59.432
] 
Dismounting '2.vhdx' to generate corruption...
[
19:23:59.483
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:24:04.536
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:24:05.711
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:24:05.712
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:24:05.713
] 
Found 'Corrupt_me_1' at position 473972736 - corrupting following character from ' ' to '!'...
[
19:24:05.718
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:24:06.436
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:24:06.790
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:24:07.464
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:24:07.532
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:24:07.578
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:24:12.700
] 
Connecting virtual disk
[
19:24:12.787
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:24:17.836
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:24:17.837
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:24:17.841
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:24:17.842
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:24:17.847
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:24:17.848
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:24:22.866
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:24:23.148
] 
Disconnecting virtual disk
[
19:24:23.227
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:24:23.267
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:24:23.316
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:24:23.366
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:24:24.163
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:24:24.525
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 10 of 20... ========
[
19:24:25.667
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:24:25.732
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:24:37.351
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:24:37.355
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x049a5b9f9a5b8c54
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:24:37.362
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:24:37.363
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:24:37.363
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:24:42.373
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:24:43.095
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:24:43.911
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:24:44.611
] 
Disconnecting virtual disk
[
19:24:44.688
] 
Dismounting '1.vhdx' to generate corruption...
[
19:24:44.745
] 
Dismounting '2.vhdx' to generate corruption...
[
19:24:44.800
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:24:49.864
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:24:50.404
] 
Found 'Corrupt_me_1' at position 339742720 - corrupting following character from ' ' to '!'...
[
19:24:50.404
] 
Found 'Corrupt_me_1' at position 339746816 - corrupting following character from ' ' to '!'...
[
19:24:50.405
] 
Found 'Corrupt_me_1' at position 339750912 - corrupting following character from ' ' to '!'...
[
19:24:50.409
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:24:50.819
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:24:51.722
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:24:52.167
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:24:52.241
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:24:52.347
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:24:57.444
] 
Connecting virtual disk
[
19:24:57.535
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:25:02.591
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:25:02.593
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:25:02.597
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:25:02.598
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:25:02.601
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:25:02.602
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:25:07.609
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:25:07.921
] 
Disconnecting virtual disk
[
19:25:07.987
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:25:08.040
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:25:08.086
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:25:08.135
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:25:08.727
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:25:09.525
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

[
19:25:10.198
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:25:10.261
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:25:21.902
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:25:21.905
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x741e75cd1e7588be
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:25:21.912
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:25:21.912
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:25:21.913
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:25:26.914
] 
Scanning uncorrupted data in 1.vhdx
[
19:25:27.245
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:25:27.973
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:25:28.969
] 
Disconnecting virtual disk
[
19:25:29.058
] 
Dismounting '1.vhdx' to generate corruption...
[
19:25:29.115
] 
Dismounting '2.vhdx' to generate corruption...
[
19:25:29.164
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:25:34.226
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:25:35.446
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:25:35.446
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:25:35.447
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:25:35.451
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:25:35.807
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:25:36.544
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:25:37.072
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:25:37.122
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:25:42.210
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:25:47.289
] 
Connecting virtual disk
[
19:25:47.407
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:25:52.456
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:25:52.457
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:25:52.462
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:25:52.462
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:25:52.466
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:25:52.467
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:25:57.477
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:25:57.772
] 
Disconnecting virtual disk
[
19:25:57.855
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:25:57.897
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:25:57.946
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:25:57.993
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:25:58.302
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:25:58.953
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 11 of 20... ========
[
19:25:59.927
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:25:59.992
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:26:11.696
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:26:11.700
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xc0ee9349ee93369e
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:26:11.707
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:26:11.707
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:26:11.707
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:26:16.714
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:26:17.371
] 
Scanning uncorrupted data in 2.vhdx
[
19:26:17.685
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:26:18.649
] 
Disconnecting virtual disk
[
19:26:18.724
] 
Dismounting '1.vhdx' to generate corruption...
[
19:26:18.782
] 
Dismounting '2.vhdx' to generate corruption...
[
19:26:18.833
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:26:23.893
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:26:24.519
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:26:24.520
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:26:24.520
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:26:24.524
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:26:24.993
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:26:25.291
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:26:26.047
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:26:26.117
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:26:26.161
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:26:36.248
] 
Connecting virtual disk
[
19:26:36.350
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:26:41.393
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:26:41.394
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:26:41.398
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:26:41.400
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:26:41.404
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:26:41.405
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:26:46.419
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:26:46.686
] 
Disconnecting virtual disk
[
19:26:46.757
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:26:46.801
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:26:46.850
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:26:46.893
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:26:47.681
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:26:47.989
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:26:48.941
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:26:49.005
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:27:04.820
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:27:04.826
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x54a0b2f9a0b2e0a2
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:27:04.841
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:27:04.841
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:27:04.841
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:27:09.842
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:27:10.569
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:27:11.251
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:27:11.864
] 
Disconnecting virtual disk
[
19:27:11.948
] 
Dismounting '1.vhdx' to generate corruption...
[
19:27:12.004
] 
Dismounting '2.vhdx' to generate corruption...
[
19:27:12.059
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:27:17.120
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:27:17.487
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:27:18.111
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:27:18.112
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:27:18.112
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:27:18.116
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:27:18.739
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:27:19.255
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:27:19.542
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:27:19.680
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:27:24.781
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:27:29.845
] 
Connecting virtual disk
[
19:27:29.940
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:27:35.001
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:27:35.001
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:27:35.006
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:27:35.007
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:27:35.010
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:27:35.011
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:27:40.026
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:27:40.327
] 
Disconnecting virtual disk
[
19:27:40.400
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:27:40.446
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:27:40.496
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:27:40.542
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:27:41.340
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:27:42.024
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

======== Test iteration 12 of 20... ========
[
19:27:42.733
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:27:42.801
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:27:54.507
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:27:54.588
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x7ea0d0bea0d07dd9
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b98f
Total Reserved :                           0x0000000000024570
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:27:54.609
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:27:54.610
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:27:54.611
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:27:59.618
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:28:00.509
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:28:01.079
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:28:01.709
] 
Disconnecting virtual disk
[
19:28:01.780
] 
Dismounting '1.vhdx' to generate corruption...
[
19:28:01.838
] 
Dismounting '2.vhdx' to generate corruption...
[
19:28:01.892
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:28:06.963
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:28:08.145
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:28:08.145
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:28:08.146
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:28:08.149
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:28:08.902
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:28:09.569
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:28:10.037
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:28:15.145
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:28:20.239
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:28:25.316
] 
Connecting virtual disk
[
19:28:25.419
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:28:30.466
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:28:30.467
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:28:30.471
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:28:30.471
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:28:30.475
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:28:30.476
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:28:35.483
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:28:35.770
] 
Disconnecting virtual disk
[
19:28:35.848
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:28:36.018
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:28:36.066
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:28:36.108
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:28:36.908
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:28:37.440
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

[
19:28:38.068
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:28:38.134
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:28:49.741
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:28:49.746
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x54ccf18fccf16c1c
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:28:49.752
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:28:49.752
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:28:49.752
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:28:54.766
] 
Scanning uncorrupted data in 1.vhdx
[
19:28:55.224
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:28:55.964
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:28:56.925
] 
Disconnecting virtual disk
[
19:28:56.991
] 
Dismounting '1.vhdx' to generate corruption...
[
19:28:57.050
] 
Dismounting '2.vhdx' to generate corruption...
[
19:28:57.098
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:29:02.160
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:29:03.454
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:29:03.455
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:29:03.455
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:29:03.458
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:29:03.910
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:29:04.566
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:29:05.173
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:29:05.224
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:29:10.320
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:29:15.471
] 
Connecting virtual disk
[
19:29:15.555
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:29:20.610
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:29:20.611
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:29:20.615
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:29:20.615
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:29:20.619
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:29:20.620
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:29:25.633
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:29:25.916
] 
Disconnecting virtual disk
[
19:29:25.999
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:29:26.051
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:29:26.098
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:29:26.138
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:29:26.546
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:29:27.206
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 13 of 20... ========
[
19:29:28.168
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:29:28.233
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:29:39.874
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:29:39.879
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x9e360f73360f4ba9
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:29:39.885
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:29:39.885
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:29:39.886
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:29:44.888
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:29:45.504
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:29:46.312
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:29:47.055
] 
Disconnecting virtual disk
[
19:29:47.119
] 
Dismounting '1.vhdx' to generate corruption...
[
19:29:47.181
] 
Dismounting '2.vhdx' to generate corruption...
[
19:29:47.229
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:29:52.274
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:29:53.233
] 
Found 'Corrupt_me_1' at position 339742720 - corrupting following character from ' ' to '!'...
[
19:29:53.234
] 
Found 'Corrupt_me_1' at position 339746816 - corrupting following character from ' ' to '!'...
[
19:29:53.234
] 
Found 'Corrupt_me_1' at position 339750912 - corrupting following character from ' ' to '!'...
[
19:29:53.238
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:29:53.676
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:29:54.530
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:29:54.945
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:29:55.021
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:29:55.127
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:30:00.186
] 
Connecting virtual disk
[
19:30:00.288
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:30:05.345
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:30:05.346
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:30:05.351
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:30:05.351
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:30:05.355
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:30:05.355
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:30:10.360
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:30:10.627
] 
Disconnecting virtual disk
[
19:30:10.701
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:30:10.749
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:30:10.798
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:30:10.838
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:30:11.396
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:30:12.134
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

[
19:30:12.775
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:30:12.838
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:30:24.481
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:30:24.484
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xbc8c2a308c29e59c
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:30:24.490
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:30:24.491
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:30:24.491
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:30:29.503
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:30:30.190
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:30:30.870
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:30:31.511
] 
Disconnecting virtual disk
[
19:30:31.599
] 
Dismounting '1.vhdx' to generate corruption...
[
19:30:31.662
] 
Dismounting '2.vhdx' to generate corruption...
[
19:30:31.715
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:30:36.763
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:30:37.577
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:30:38.245
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:30:38.245
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:30:38.246
] 
Found 'Corrupt_me_1' at position 406863872 - corrupting following character from ' ' to '!'...
[
19:30:38.250
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:30:38.965
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:30:39.537
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:30:39.832
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:30:39.904
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:30:40.006
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:30:45.098
] 
Connecting virtual disk
[
19:30:45.189
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:30:50.230
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:30:50.231
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:30:50.235
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:30:50.235
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:30:50.241
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:30:50.242
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:30:55.256
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:30:55.533
] 
Disconnecting virtual disk
[
19:30:55.611
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:30:55.656
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:30:55.704
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:30:55.748
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:30:56.451
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:30:57.128
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

======== Test iteration 14 of 20... ========
[
19:30:57.768
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:30:57.833
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:31:09.507
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:31:09.510
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xfc1444fa1444b982
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:31:09.517
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:31:09.517
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:31:09.517
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:31:14.530
] 
Scanning uncorrupted data in 1.vhdx
[
19:31:14.954
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:31:15.706
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:31:16.673
] 
Disconnecting virtual disk
[
19:31:16.755
] 
Dismounting '1.vhdx' to generate corruption...
[
19:31:16.816
] 
Dismounting '2.vhdx' to generate corruption...
[
19:31:16.867
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:31:22.028
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:31:22.753
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:31:24.025
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:31:24.031
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:31:24.032
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:31:24.036
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:31:24.597
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:31:25.359
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:31:26.107
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:31:26.192
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:31:26.359
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:31:36.485
] 
Connecting virtual disk
[
19:31:36.591
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:31:41.623
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:31:41.631
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:31:41.636
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:31:41.637
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:31:41.641
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:31:41.642
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:31:46.655
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:31:46.935
] 
Disconnecting virtual disk
[
19:31:47.012
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:31:47.059
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:31:47.110
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:31:47.156
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:31:47.605
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:31:48.308
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:31:49.294
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:31:49.367
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:32:01.042
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:32:01.048
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xb47a63b67a637450
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:32:01.064
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:32:01.065
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:32:01.065
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:32:06.075
] 
Scanning uncorrupted data in 1.vhdx
[
19:32:06.522
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:32:07.443
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:32:08.217
] 
Disconnecting virtual disk
[
19:32:08.296
] 
Dismounting '1.vhdx' to generate corruption...
[
19:32:08.358
] 
Dismounting '2.vhdx' to generate corruption...
[
19:32:08.414
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:32:13.472
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:32:14.597
] 
Found 'Corrupt_me_1' at position 339746816 - corrupting following character from ' ' to '!'...
[
19:32:14.597
] 
Found 'Corrupt_me_1' at position 339750912 - corrupting following character from ' ' to '!'...
[
19:32:14.598
] 
Found 'Corrupt_me_1' at position 339755008 - corrupting following character from ' ' to '!'...
[
19:32:14.602
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:32:15.072
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:32:16.070
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:32:16.495
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:32:16.595
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:32:21.720
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:32:26.785
] 
Connecting virtual disk
[
19:32:26.882
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:32:31.940
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:32:31.943
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:32:31.949
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:32:31.950
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:32:31.954
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:32:31.954
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:32:36.973
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:32:37.260
] 
Disconnecting virtual disk
[
19:32:37.348
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:32:37.394
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:32:37.440
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:32:37.484
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:32:37.899
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:32:38.633
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 15 of 20... ========
[
19:32:39.447
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:32:39.512
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:32:51.199
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:32:51.204
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x601a81871a815ac4
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:32:51.210
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:32:51.211
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:32:51.211
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:32:56.217
] 
Scanning uncorrupted data in 1.vhdx
[
19:32:56.540
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:32:57.328
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:32:58.205
] 
Disconnecting virtual disk
[
19:32:58.290
] 
Dismounting '1.vhdx' to generate corruption...
[
19:32:58.352
] 
Dismounting '2.vhdx' to generate corruption...
[
19:32:58.404
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:33:03.467
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:33:04.055
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:33:05.236
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:33:05.237
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:33:05.237
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:33:05.241
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:33:05.499
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:33:06.151
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:33:06.816
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:33:06.888
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:33:06.997
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:33:12.104
] 
Connecting virtual disk
[
19:33:12.211
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:33:17.248
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:33:17.250
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:33:17.259
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:33:17.261
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:33:17.265
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:33:17.265
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:33:22.283
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:33:22.587
] 
Disconnecting virtual disk
[
19:33:22.670
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:33:22.720
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:33:22.769
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:33:22.815
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:33:23.131
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:33:23.898
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:33:24.806
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:33:24.872
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:33:36.497
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:33:36.502
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xb89c9c9f9c9c5a28
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:33:36.509
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:33:36.509
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:33:36.509
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:33:41.511
] 
Scanning uncorrupted data in 1.vhdx
[
19:33:41.965
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:33:42.545
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:33:43.530
] 
Disconnecting virtual disk
[
19:33:43.628
] 
Dismounting '1.vhdx' to generate corruption...
[
19:33:43.689
] 
Dismounting '2.vhdx' to generate corruption...
[
19:33:43.742
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:33:48.891
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:33:50.158
] 
Found 'Corrupt_me_1' at position 473960448 - corrupting following character from ' ' to '!'...
[
19:33:50.165
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:33:50.165
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:33:50.169
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:33:50.601
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:33:51.222
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:33:52.045
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:33:52.102
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:33:57.179
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:34:02.303
] 
Connecting virtual disk
[
19:34:02.399
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:34:07.448
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:34:07.456
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:34:07.462
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:34:07.463
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:34:07.467
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:34:07.467
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:34:12.476
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:34:12.754
] 
Disconnecting virtual disk
[
19:34:12.834
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:34:12.884
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:34:12.934
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:34:12.969
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:34:13.453
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:34:14.128
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 16 of 20... ========
[
19:34:15.375
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:34:15.468
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:34:31.359
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:34:31.364
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x14debd2fdebd0a4e
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:34:31.373
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:34:31.373
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:34:31.373
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:34:36.382
] 
Scanning uncorrupted data in 1.vhdx
[
19:34:36.895
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:34:37.655
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:34:38.816
] 
Disconnecting virtual disk
[
19:34:38.892
] 
Dismounting '1.vhdx' to generate corruption...
[
19:34:38.954
] 
Dismounting '2.vhdx' to generate corruption...
[
19:34:39.007
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:34:44.076
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:34:44.562
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:34:45.252
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:34:45.253
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:34:45.253
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:34:45.262
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:34:45.588
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:34:46.122
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:34:46.806
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:34:46.888
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:34:46.992
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:34:52.110
] 
Connecting virtual disk
[
19:34:52.209
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:34:57.266
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:34:57.271
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:34:57.277
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:34:57.278
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:34:57.281
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:34:57.282
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:35:02.298
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:35:02.583
] 
Disconnecting virtual disk
[
19:35:02.665
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:35:02.712
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:35:02.759
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:35:02.805
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:35:03.252
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:35:03.941
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:35:04.820
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:35:04.897
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:35:16.673
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:35:16.677
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x0270d81170d80cf3
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:35:16.683
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:35:16.684
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:35:16.684
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:35:21.691
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:35:22.392
] 
Scanning uncorrupted data in 2.vhdx
[
19:35:22.860
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:35:23.772
] 
Disconnecting virtual disk
[
19:35:23.853
] 
Dismounting '1.vhdx' to generate corruption...
[
19:35:23.915
] 
Dismounting '2.vhdx' to generate corruption...
[
19:35:23.970
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:35:29.117
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:35:29.817
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:35:29.818
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:35:29.818
] 
Found 'Corrupt_me_1' at position 406863872 - corrupting following character from ' ' to '!'...
[
19:35:29.822
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:35:30.512
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:35:30.938
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:35:31.434
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:35:31.519
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:35:31.655
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:35:36.775
] 
Connecting virtual disk
[
19:35:36.882
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:35:41.933
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:35:41.937
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:35:41.942
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:35:41.943
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:35:41.947
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:35:41.947
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:35:46.952
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:35:47.244
] 
Disconnecting virtual disk
[
19:35:47.330
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:35:47.383
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:35:47.433
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:35:47.470
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:35:48.140
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:35:48.597
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 17 of 20... ========
[
19:35:49.487
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:35:49.552
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:36:01.333
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:36:01.338
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xb00af2e80af2ab0c
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:36:01.343
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:36:01.344
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:36:01.344
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:36:06.349
] 
Scanning uncorrupted data in 1.vhdx
[
19:36:06.828
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:36:07.600
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:36:08.557
] 
Disconnecting virtual disk
[
19:36:08.629
] 
Dismounting '1.vhdx' to generate corruption...
[
19:36:08.690
] 
Dismounting '2.vhdx' to generate corruption...
[
19:36:08.753
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:36:13.816
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:36:14.601
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:36:15.288
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:36:15.288
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:36:15.288
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:36:15.292
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:36:15.735
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:36:16.434
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:36:17.302
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:36:17.384
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:36:17.491
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:36:22.655
] 
Connecting virtual disk
[
19:36:22.746
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:36:27.780
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:36:27.783
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:36:27.790
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:36:27.791
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:36:27.795
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:36:27.795
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:36:32.813
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:36:33.105
] 
Disconnecting virtual disk
[
19:36:33.187
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:36:33.235
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:36:33.286
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:36:33.331
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:36:33.759
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:36:34.543
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:36:35.448
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:36:35.517
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:36:47.196
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:36:47.200
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x86620e0c620e0223
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:36:47.215
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:36:47.216
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:36:47.216
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:36:52.232
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:36:52.912
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:36:53.592
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:36:54.228
] 
Disconnecting virtual disk
[
19:36:54.331
] 
Dismounting '1.vhdx' to generate corruption...
[
19:36:54.393
] 
Dismounting '2.vhdx' to generate corruption...
[
19:36:54.449
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:36:59.497
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:37:00.249
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:37:00.913
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:37:00.914
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:37:00.914
] 
Found 'Corrupt_me_1' at position 406863872 - corrupting following character from ' ' to '!'...
[
19:37:01.005
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:37:01.746
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:37:02.267
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:37:02.551
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:37:07.675
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:37:12.786
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:37:17.853
] 
Connecting virtual disk
[
19:37:17.959
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:37:23.020
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:37:23.129
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:37:23.133
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:37:23.134
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:37:23.137
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:37:23.138
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:37:28.155
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:37:28.438
] 
Disconnecting virtual disk
[
19:37:28.521
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:37:28.568
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:37:28.615
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:37:28.657
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:37:29.295
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:37:29.933
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

======== Test iteration 18 of 20... ========
[
19:37:30.645
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:37:30.708
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:37:42.452
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:37:42.456
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x0a902eff902ef13d
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:37:42.462
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:37:42.463
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:37:42.463
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:37:47.472
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:37:48.154
] 
Scanning uncorrupted data in 2.vhdx
[
19:37:48.653
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:37:49.690
] 
Disconnecting virtual disk
[
19:37:49.759
] 
Dismounting '1.vhdx' to generate corruption...
[
19:37:49.811
] 
Dismounting '2.vhdx' to generate corruption...
[
19:37:49.864
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:37:54.910
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:37:55.695
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:37:55.696
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:37:55.696
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:37:55.700
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:37:56.247
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:37:56.675
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:37:57.333
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:37:57.416
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:37:57.513
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:38:02.630
] 
Connecting virtual disk
[
19:38:02.734
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:38:07.783
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:38:07.785
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:38:07.790
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:38:07.791
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:38:07.795
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:38:07.796
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:38:12.800
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:38:13.119
] 
Disconnecting virtual disk
[
19:38:13.195
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:38:13.241
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:38:13.289
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:38:13.331
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:38:14.001
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:38:14.419
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:38:15.351
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:38:15.423
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:38:27.122
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:38:27.126
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x2cf449c3f4498fce
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:38:27.132
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:38:27.133
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:38:27.133
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:38:32.145
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:38:32.871
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:38:33.605
] 
Scanning uncorrupted data in 3.vhdx
Writing Volume Cache
[
19:38:34.241
] 
Disconnecting virtual disk
[
19:38:34.318
] 
Dismounting '1.vhdx' to generate corruption...
[
19:38:34.382
] 
Dismounting '2.vhdx' to generate corruption...
[
19:38:34.436
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:38:39.488
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:38:40.177
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:38:41.021
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:38:41.021
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:38:41.021
] 
Found 'Corrupt_me_1' at position 406863872 - corrupting following character from ' ' to '!'...
[
19:38:41.026
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:38:41.672
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:38:42.197
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:38:42.490
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:38:42.573
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:38:42.672
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:38:52.782
] 
Connecting virtual disk
[
19:38:52.878
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:38:57.925
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:38:57.933
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:38:57.941
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:38:57.941
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:38:57.945
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:38:57.945
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:39:02.957
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:39:03.246
] 
Disconnecting virtual disk
[
19:39:03.328
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:39:03.374
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:39:03.420
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:39:03.466
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:39:04.136
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:39:04.802
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...

======== Test iteration 19 of 20... ========
[
19:39:05.457
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:39:05.526
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:39:17.211
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:39:17.216
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0xd8f2678bf2676ca6
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:39:17.222
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:39:17.222
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:39:17.223
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:39:22.235
] 
Scanning uncorrupted data in 1.vhdx
[
19:39:22.772
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:39:23.546
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:39:24.449
] 
Disconnecting virtual disk
[
19:39:24.535
] 
Dismounting '1.vhdx' to generate corruption...
[
19:39:24.592
] 
Dismounting '2.vhdx' to generate corruption...
[
19:39:24.649
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:39:29.795
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:39:30.445
] 
Searching '2.vhdx' for 'Corrupt_me_1'...
[
19:39:31.694
] 
Found 'Corrupt_me_1' at position 406851584 - corrupting following character from ' ' to '!'...
[
19:39:31.695
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:39:31.695
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:39:31.703
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:39:32.106
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:39:32.704
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:39:33.541
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:39:38.647
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:39:43.767
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:39:53.886
] 
Connecting virtual disk
[
19:39:53.994
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:39:59.044
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:39:59.047
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:39:59.061
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:39:59.061
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:39:59.175
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:39:59.176
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:40:04.197
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:40:04.515
] 
Disconnecting virtual disk
[
19:40:04.587
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:40:04.641
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:40:04.689
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:40:04.748
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:40:05.302
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:40:06.227
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:40:07.402
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:40:07.497
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:40:37.507
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:40:37.512
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x14f69764f6974540
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:40:37.520
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:40:37.520
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:40:37.521
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:40:42.536
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:40:43.266
] 
Scanning uncorrupted data in 2.vhdx
[
19:40:43.606
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:40:44.601
] 
Disconnecting virtual disk
[
19:40:44.673
] 
Dismounting '1.vhdx' to generate corruption...
[
19:40:44.736
] 
Dismounting '2.vhdx' to generate corruption...
[
19:40:44.791
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:40:49.845
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:40:51.058
] 
Found 'Corrupt_me_1' at position 473964544 - corrupting following character from ' ' to '!'...
[
19:40:51.059
] 
Found 'Corrupt_me_1' at position 473968640 - corrupting following character from ' ' to '!'...
[
19:40:51.059
] 
Found 'Corrupt_me_1' at position 473972736 - corrupting following character from ' ' to '!'...
[
19:40:51.063
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:40:51.756
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:40:52.075
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:40:52.819
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:40:52.896
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:40:57.986
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:41:03.115
] 
Connecting virtual disk
[
19:41:03.222
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:41:08.279
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:41:08.285
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:41:08.291
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:41:08.292
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:41:08.296
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:41:08.297
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:41:13.315
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:41:13.634
] 
Disconnecting virtual disk
[
19:41:13.723
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:41:13.770
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:41:13.824
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:41:13.875
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:41:14.685
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:41:15.026
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

======== Test iteration 20 of 20... ========
[
19:41:16.155
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:41:16.225
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:41:27.971
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:41:27.974
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x74acb5a1acb55df4
REFS Version   :                           3.9
Number Sectors :                           0x00000000007e0000
Total Clusters :                           0x00000000000fc000
Free Clusters  :                           0x00000000000bb9de
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:41:27.980
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:41:27.981
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:41:27.981
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:41:32.988
] 
Scanning uncorrupted data in 1.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:41:33.719
] 
Scanning uncorrupted data in 2.vhdx
[
19:41:34.201
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:41:35.077
] 
Disconnecting virtual disk
[
19:41:35.165
] 
Dismounting '1.vhdx' to generate corruption...
[
19:41:35.222
] 
Dismounting '2.vhdx' to generate corruption...
[
19:41:35.276
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:41:40.341
] 
Searching '1.vhdx' for 'Corrupt_me_1'...
[
19:41:41.106
] 
Found 'Corrupt_me_1' at position 406855680 - corrupting following character from ' ' to '!'...
[
19:41:41.106
] 
Found 'Corrupt_me_1' at position 406859776 - corrupting following character from ' ' to '!'...
[
19:41:41.107
] 
Found 'Corrupt_me_1' at position 406863872 - corrupting following character from ' ' to '!'...
[
19:41:41.111
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:41:41.707
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:41:42.135
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:41:42.838
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:41:43.012
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:41:43.069
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:41:48.142
] 
Connecting virtual disk
[
19:41:48.240
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:41:53.283
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:41:53.285
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:41:53.292
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:41:53.294
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:41:53.300
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:41:53.301
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:41:58.312
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:41:58.612
] 
Disconnecting virtual disk
[
19:41:58.695
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:41:58.751
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:41:58.803
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:41:58.849
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:41:59.606
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:42:00.085
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

[
19:42:01.012
] 
Starting script on Microsoft Windows 11 Pro for Workstations 22H2 (OS Build 22621.2134)...
[
19:42:01.082
] 
Creating Mirror ReFS volume with 3 VHDs and 1 Disk Redundancy in Windows Storage Spaces...
[
19:42:16.973
] 
Enabling ReFS Integrity Streams on ReFS volume with Storage Spaces...
[
19:42:16.977
] 
Displaying refsinfo for newly created volume...
REFS Volume Serial Number :                0x9e38d2b738d28e21
REFS Version   :                           3.9
Number Sectors :                           0x00000000005e0000
Total Clusters :                           0x00000000000bc000
Free Clusters  :                           0x000000000007b9df
Total Reserved :                           0x0000000000024530
Bytes Per Sector  :                        512
Bytes Per Physical Sector :                4096
Bytes Per Cluster :                        4096
Fast Tier Data Fill Percentage :           0.0%
Slow Tier Data Fill Percentage :           0.0%
Fast Tier to Slow Tier Rate (Clusters/s) : 0
Checksum Type :                            CHECKSUM_TYPE_CRC32

[
19:42:16.984
] 
Creating text file 'T:\test1.0001.txt' with test file contents 'Corrupt_me_1 0001'...
[
19:42:16.984
] 
Creating text file 'T:\test1.0002.txt' with test file contents 'Corrupt_me_1 0002'...
[
19:42:16.984
] 
Creating text file 'T:\test1.0003.txt' with test file contents 'Corrupt_me_1 0003'...
Sleeping for 5s...
[
19:42:21.994
] 
Scanning uncorrupted data in 1.vhdx
[
19:42:22.460
] 
Scanning uncorrupted data in 2.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:42:23.263
] 
Scanning uncorrupted data in 3.vhdx
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
Writing Volume Cache
[
19:42:24.114
] 
Disconnecting virtual disk
[
19:42:24.198
] 
Dismounting '1.vhdx' to generate corruption...
[
19:42:24.267
] 
Dismounting '2.vhdx' to generate corruption...
[
19:42:24.322
] 
Dismounting '3.vhdx' to generate corruption...
Sleeping for 5s...
[
19:42:29.480
] 
Searching '3.vhdx' for 'Corrupt_me_1'...
[
19:42:30.560
] 
Found 'Corrupt_me_1' at position 339742720 - corrupting following character from ' ' to '!'...
[
19:42:30.561
] 
Found 'Corrupt_me_1' at position 339746816 - corrupting following character from ' ' to '!'...
[
19:42:30.561
] 
Found 'Corrupt_me_1' at position 339750912 - corrupting following character from ' ' to '!'...
[
19:42:30.566
] 
Scanning '1.vhdx' to verify uncorrupted or corrupted data before repair...
[
19:42:31.008
] 
Scanning '2.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:42:31.796
] 
Scanning '3.vhdx' to verify uncorrupted or corrupted data before repair...
Corrupt_me_1!0001
Corrupt_me_1!0002
Corrupt_me_1!0003
[
19:42:32.264
] 
Remounting '1.vhdx' to test Integrity Streams corruption detection & repair...
[
19:42:32.349
] 
Remounting '2.vhdx' to test Integrity Streams corruption detection & repair...
[
19:42:32.522
] 
Remounting '3.vhdx' to test Integrity Streams corruption detection & repair...
Sleeping for 5s...
[
19:42:37.588
] 
Connecting virtual disk
[
19:42:37.692
] 
Waiting for Storage Pool to reach Healthy status...

HealthStatus OperationalStatus ReadOnlyReason
------------ ----------------- --------------
Healthy      OK                None

Sleeping for 5s...
[
19:42:42.741
] 
Attempting to read 'T:\test1.0001.txt' - should be able to read without errors...
Corrupt_me_1 0001
[
19:42:42.744
] 
Attempting manual scrub / repair on 'T:\test1.0001.txt'...
[
19:42:42.750
] 
Attempting to read 'T:\test1.0002.txt' - should be able to read without errors...
Corrupt_me_1 0002
[
19:42:42.751
] 
Attempting manual scrub / repair on 'T:\test1.0002.txt'...
[
19:42:42.754
] 
Attempting to read 'T:\test1.0003.txt' - should be able to read without errors...
Corrupt_me_1 0003
[
19:42:42.755
] 
Attempting manual scrub / repair on 'T:\test1.0003.txt'...
Sleeping for 5s...
[
19:42:47.765
] 
Reading event logs to verify corruption & any fixes are logged in System Event log...
Get-WinEvent: C:\Users\xxx.xxx\source\repos\Borgquite\Test-ReFSDataCorruption\Test-ReFSDataCorruption.ps1:388
Line |
 388 |      Get-WinEvent -FilterHashtable @{ StartTime=$scriptstarttime; LogN …
     |      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
     | No events were found that match the specified selection criteria.

Writing Volume Cache
[
19:42:48.036
] 
Disconnecting virtual disk
[
19:42:48.114
] 
Dismounting '1.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:42:48.163
] 
Dismounting '2.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:42:48.207
] 
Dismounting '3.vhdx' to verify whether corruption was correctly detected & repaired on all drives...
[
19:42:48.254
] 
Scanning '1.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
[
19:42:48.690
] 
Scanning '2.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003
[
19:42:49.509
] 
Scanning '3.vhdx' for uncorrupted or corrupted data - all except set 0 should be uncorrupted...
Corrupt_me_1 0001
Corrupt_me_1 0002
Corrupt_me_1 0003

